<!DOCTYPE html>
<html>

<head>

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="">
<meta name="author" content="">

<title>íšŒì›ê°€ì… - ì½”ë“œë¸”ë£¨</title>

<!-- Custom fonts for this template-->
<link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">

<!-- Custom styles for this template-->
<link href="css/sb-admin-2.min.css" rel="stylesheet">
<!-- Custom styles for codeBlue -->
<link href="css/codeBlue.css" rel="stylesheet">
<!-- import JQuery library -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
</head>

<body style="background: #ebebeb; height: 94vh">
 
	<!-- Topbar -->
	<div id="topBar"></div>
	<!-- End of Topbar -->

		<!-- Begin Page Content -->
		<div class="container" style="height: 100%">  
			<div class="row pt-5 my-5">
				<div class="col-sm-6 mt-5 pt-5 px-5"><!-- explain codeBlue member í˜œíƒ -->
					<img src="/img/codeBlueLogo.png" width="250px"> 
					<h1 class="text-primary h4 mt-2">íšŒì›ì´ ë˜ì–´ë³¼ê¹Œìš”?</h1>
					<label>ì½”ë“œë¸”ë£¨ íšŒì›ë“¤ì€ ...</label>
					<img src="img/vote.svg" width="100%" class="my-4">
					<hr>
					<a href="/registerExpert">ì „ë¬¸ê°€ íšŒì›ê°€ì…ì€ ì–´ë–»ê²Œ í•˜ì£ ?</a>
				</div>
				
				<div class="col-sm-6 mt-4 text-left mb-3" align="center">
					<!-- register Form begin -->
					<div class="card shadow p-1 mx-5 mb-5"> 
						<form class="was-validated card-body">
						  <div class="form-group">
						    <label class="text-dark font-weight-bold" for="id">ì•„ì´ë””</label>
						    <input type="email" class="form-control form-control-sm" id="id" placeholder="E-Mail@example.com" required>
						    <div class="valid-feedback" id="checkedId"><a href="#" class="text-danger" onclick="checkUserId()"><strong>ì¤‘ë³µê²€ì‚¬ë¥¼ ìœ„í•´ ì—¬ê¸°ë¥¼ í´ë¦­!</strong> ì¤‘ë³µ ê²€ì‚¬ë¥¼ ì™„ë£Œí•´ ì£¼ì„¸ìš”!ğŸ‘ˆğŸ‘ˆ</a></div>
						    <div class="invalid-feedback">ì˜¬ë°”ë¥¸ ì´ë©”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.</div>
						  </div>
						  <div class="form-group">
						    <label class="text-dark font-weight-bold" for="name">ë‹‰ë„¤ì„</label>
						    <input type="text" class="form-control form-control-sm" id="name" placeholder="ì´ë¦„" required>
						    <div class="valid-feedback">ì¢‹ì•„ìš”.</div>
						    <div class="invalid-feedback">ë‹‰ë„¤ì„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.</div>
						  </div>
						  <div class="form-group">
						    <label class="text-dark font-weight-bold" for="pw">ë¹„ë°€ë²ˆí˜¸</label>
						    <input type="password" class="form-control form-control-sm" id="pw" placeholder="ë¹„ë°€ë²ˆí˜¸" required>
						    <div class="valid-feedback">ì¢‹ì•„ìš”.</div>
						    <div class="invalid-feedback">ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.</div>
						  </div>
						  
						  <div class="form-group">
						    <label class="text-dark font-weight-bold" for="pw2">ë¹„ë°€ë²ˆí˜¸ í™•ì¸</label>
						    <input type="password" class="form-control form-control-sm" id="pw2" placeholder="ë¹„ë°€ë²ˆí˜¸" required>
						    <div class="valid-feedback">ì¢‹ì•„ìš”.</div>
						    <div class="invalid-feedback">ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.</div>
						  </div> 
						  <div class="form-group">
						    <label class="text-dark font-weight-bold" for="birthDate">ìƒì¼</label>
						    <input type="date" class="form-control form-control-sm" id="birthDate" required>
						    <div class="valid-feedback">ì¢‹ì•„ìš”.</div>
						    <div class="invalid-feedback">ìƒì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.</div>
						  </div> 
						  <div class="form-group">
						    <label class="text-dark font-weight-bold" for="region">í™œë™ì§€</label>
						    <select class="form-control form-control-sm" id="region" required></select> 
						    <div class="valid-feedback">ì¢‹ì•„ìš”.</div>
						    <div class="invalid-feedback">í™œë™ì§€ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.</div>
						  </div> 
						  <button type="button" class="btn btn-block btn-primary join" id="join">íšŒì›ê°€ì…</button> 
						 </form> 
						  <!-- ì…ë ¥ í´ë¦­ì‹œ ì¸ì¦ì½”ë“œ ì…ë ¥ë€ ì¶œë ¥ -->
						  <b class="text-sm card mt-3 mx-3 p-3 text-center text-primary shadow" id="notice" style="display:none">ì¸ì¦ ë©”ì¼ì´ ì „ì†¡ ë˜ì—ˆìŠµë‹ˆë‹¤!</b>
						  <form class="was-validated card-body" > 
							  <div id="codeForm" style="display:none">	  
							  	<div class="form-group">
							    	<label class="text-dark font-weight-bold" for="code">ì¸ì¦ì½”ë“œ</label>
							    	<input type="text" class="form-control" id="code" placeholder="ì¸ì¦ì½”ë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”" required>
							    	<div class="valid-feedback">ì¢‹ì•„ìš”.</div>
							    	<div class="invalid-feedback">ì¸ì¦ ì½”ë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš” ğŸ†</div> 
							  	</div> 
							  	<button type="button" id="confirmCode" class="btn btn-block btn-outline-primary">í™•ì¸</button>  
								<a href="#" id="resend" class="small text-center">ë©”ì¼ì„ ëª» ë°›ìœ¼ì…¨ë‚˜ìš”? ë‹¤ì‹œ ë³´ë‚´ë“œë¦½ë‹ˆë‹¤!</a> 
							  </div>
						  </form>
						  <div class="card bg-primary m-3 p-3 text-center shadow" style="display:none" id="joinComplete">
							  <h4 class="my-2 p-2 text-center text-light font-weight-bold" id="ok"></h4>
							  <a href="/login" class="text-warning nav-link font-weight-bold" id="toLogin"></a>
						  </div> 
					</div>
					<!-- register Form end -->
				</div>
				
				
			</div> 
		</div> 
		<!-- Page Content End --> 

	<!-- Bootstrap core JavaScript-->
	<script src="vendor/jquery/jquery.min.js"></script>
	<script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

	<!-- Core plugin JavaScript-->
	<script src="vendor/jquery-easing/jquery.easing.min.js"></script>

	<!-- Custom scripts for all pages-->
	<script src="js/sb-admin-2.min.js"></script>
  	<!-- CodeBlue scripts -->
  	<script src="js/codeBlueUser.js"></script>

</body>
<script> 
function checkUserId(){
	console.log($("#id").val())
	$.ajax({
		url : "/rest/userOne",
		method : "post",
		data : {"userId":$("#id").val()},
		success : function(json){
			console.log(json);
			if(json != ""){
				alert("ì•„ì´ë””ê°€ ì¡´ì¬í•©ë‹ˆë‹¤!");
				return;
			}
			if(confirm("ì•„ì´ë””ê°€ ì—†ìŠµë‹ˆë‹¤! í•´ë‹¹ ì£¼ì†Œë¡œ ì•„ì´ë””ë¥¼ ìƒì„±í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")){
				alert("ê²°ì •í•˜ë©´ ë˜ëŒë¦´ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
				
				$('#id').prop('readonly', true); 
				$("#checkedId").empty();
				$("#checkedId").append("ì´ë©”ì¼ ê²°ì • ì™„ë£Œ! â˜º")
				$('#join').prop('disabled', false); 
			}
		}
	})
}

$(document).ready(function(){
	$('#join').prop('disabled', true); 
	$.ajax({
		url : "/rest/getRegionList",
		method : "get",
		success : function(json){
			console.log(json);
			let region;
			$(json).each(function(index,item){
				region = "<option value='";
				region += item.regionId;
				region += "'>";
				region += item.regionName;
				region += "</option>";
				$("#region").append(region);
			})
		}
	})
})
		
		

$(".join").click(function(){
	console.log("ì…ë ¥ì™„ë£Œ ë©”ì¼ì „ì†¡ ì‹œì‘.");
	if($("#pw").val() != $("#pw2").val()){
		alert("ì…ë ¥í•˜ì‹  ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë¦½ë‹ˆë‹¤. í™•ì¸í•´ ì£¼ì„¸ìš”");				
		return;
	}
	if($("#id").val()=="" || $("#name").val()=="" || $("#pw").val()==""){
		alert("ë¹ˆì¹¸ì„ ì±„ì›Œì£¼ì„¸ìš”!");
		return;
	} 
	
	$(".join").empty();
	$(".join").append('<span class="spinner-border spinner-border-sm"></span>');
	console.log("ì…ë ¥ì™„ë£Œ ë©”ì¼ì „ì†¡ ì‹œì‘.");
	
	$.ajax({
		url:"/rest/sendEmailToConfirm",
		data:{ "userId" : $("#id").val() , "userName" : $("#name").val() },
		method:"post", 
		success:function(){
			console.log("ë©”ì¼ ì „ì†¡ ì™„ë£Œ!")
			$("#notice").fadeIn(300); 
			setTimeout(function() {
				$("#codeForm").slideDown(500); 
			}, 300);
			
			$(".join").empty();
			$(".join").append('ë©”ì¼ ì „ì†¡ ì™„ë£Œ!');
			
			$('#id').prop('readonly', true); 
			$("#name").prop('readonly', true); 
			$("#pw").prop('readonly', true);  
			$(".join").prop('disabled', true);  
			
			console.log($('#id').val());
			console.log($('#name').val()); 
		}

	})
	 
})

$("#resend").click(function(){
	console.log("ì…ë ¥ì™„ë£Œ ë©”ì¼ì „ì†¡ ì‹œì‘.");
	
	$.ajax({
		url:"/rest/sendEmailToConfirm",
		data:{ "userId" : $("#id").val() , "userName" : $("#name").val() },
		method:"post", 
		success:function(){
			console.log("ë©”ì¼ ì „ì†¡ ì™„ë£Œ!")
			$("#notice").fadeIn(300); 
			setTimeout(function() {
				$("#codeForm").slideDown(500); 
			}, 300);
			
			$('#id').prop('readonly', true); 
			$("#name").prop('readonly', true); 
			$("#pw").prop('readonly', true);  
			$(".join").prop('disabled', true);  
			
			console.log($('#id').val());
			console.log($('#name').val()); 
		}

	})
	 
})
 
$("#confirmCode").click(function(){
	console.log("ì½”ë“œ ê²€ì‚¬");
 	$.ajax({
 		url:"/rest/verifyCode",
		data:{ 	"userId" : $("#id").val() , 
				"userName" : $("#name").val(),
				"userPw" : $("#pw").val(), 
				"code" : $("#code").val(),
				"userBirthdate" : $("#birthDate").val(),
				"region.regionId" : $("#region").val() 
				},
		method:"post", 
		async : "true",
		success:function(json){
			console.log(json);
			if(json == false){
				alert("ì½”ë“œê°€ í‹€ë ¸ìŠµë‹ˆë‹¤! ë‹¤ì‹œ ì‹œë„í•˜ì—¬ ì£¼ì„¸ìš”. :( ")
				return;
			}
			$("#code").prop("disabled", true);
			$("#confirmCode").prop("disabled", true);
			$('#resend').css("display", "none");  
			
			$("#joinComplete").fadeIn(300);
			setTimeout(function() {
				$("#ok").append("íšŒì›ì´ ë˜ì‹  ê²ƒì„<br>í™˜ì˜í•©ë‹ˆë‹¤ ğŸ†!");
				$("#toLogin").append("ë¡œê·¸ì¸ í•˜ëŸ¬ ê°€ë³¼ê¹Œìš”?");
			}, 300);	
			
			alert("íšŒì›ê°€ì… ì™„ë£Œ! í™˜ì˜í•©ë‹ˆë‹¤~!")
			location.replace("/login");	
			
		},
		fail:function(){
			alert("ì•Œ ìˆ˜ ì—†ëŠ” ì—ëŸ¬ê°‘ ë°œìƒ í–ˆìŠµë‹ˆë‹¤! ë‹¤ì‹œ ì‹œë„í•˜ì—¬ ì£¼ì„¸ìš” ğŸ˜¥");
		}
	})

})  
</script>
</html>
